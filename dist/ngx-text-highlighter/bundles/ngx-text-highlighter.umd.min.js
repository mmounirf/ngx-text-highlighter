!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@angular/core"),require("@angular/common"),require("@angular/platform-browser")):"function"==typeof define&&define.amd?define("ngx-text-highlighter",["exports","@angular/core","@angular/common","@angular/platform-browser"],e):e(t["ngx-text-highlighter"]={},t.ng.core,t.ng.common,t.ng.platformBrowser)}(this,function(t,o,e,r){"use strict";var n=function(){function t(){}return t.decorators=[{type:o.Injectable,args:[{providedIn:"root"}]}],t.ctorParameters=function(){return[]},t.ngInjectableDef=o.defineInjectable({factory:function(){return new t},token:t,providedIn:"root"}),t}(),i=function(){function t(){this.event=new o.EventEmitter}return t.prototype.dispatch=function(t){this.event.emit(t)},t.prototype.listen=function(){return this.event},t.decorators=[{type:o.Injectable,args:[{providedIn:"root"}]}],t.ctorParameters=function(){return[]},t.ngInjectableDef=o.defineInjectable({factory:function(){return new t},token:t,providedIn:"root"}),t}(),s=function(){function t(t){this.events=t,this.textSelection=new o.EventEmitter,this.markerStyle="fixed"}return t.prototype.ngOnInit=function(){var e=this;this.events.listen().subscribe(function(t){switch(t.origin){case"textarea":e.textSelection.emit({selection:t.selection,mouseEvent:t.mouseEvent})}})},t.prototype.ngOnDestroy=function(){this.events.listen().unsubscribe()},t.decorators=[{type:o.Component,args:[{selector:"th-container",template:'\n    <th-marker [markerStyle]="markerStyle"></th-marker>\n    <th-textarea></th-textarea>\n    <th-stored-highlights></th-stored-highlights>\n  ',styles:[]}]}],t.ctorParameters=function(){return[{type:i}]},t.propDecorators={textSelection:[{type:o.Output}],markerStyle:[{type:o.Input,args:["markerStyle"]}]},t}(),a=function(){function t(t,e){this._document=t,this.events=e,this.blur=new o.EventEmitter}return t.prototype.ngOnInit=function(){var e=this;this.events.listen().subscribe(function(t){"marker"===t.origin&&"highlight"===t.type&&e.marker(t.color,e.selectedText)})},t.prototype.restoreSelection=function(){if(!this.savedSelection)return!1;if(window.getSelection){var t=window.getSelection();return t.removeAllRanges(),t.addRange(this.savedSelection),!0}return!!this._document.getSelection||void 0},t.prototype.marker=function(t,e){this.restoreSelection()&&(this._document.execCommand("hiliteColor",!1,t),this.events.dispatch({origin:"textarea",type:"store",color:t,text:e}))},t.prototype.onTextAreaBlur=function(){if(this.events.dispatch({origin:"textarea",type:"blur"}),window.getSelection){var t=window.getSelection();t.getRangeAt&&t.rangeCount&&(this.savedSelection=t.getRangeAt(0),this.selectedText=t.toString())}else this._document.getSelection&&this._document.createRange?this.savedSelection=document.createRange():this.savedSelection=null},t.prototype.onSelection=function(t){var e=window.getSelection();"Range"===e.type&&this.events.dispatch({origin:"textarea",type:"selection",value:e}),"Range"!==e.type&&this.events.dispatch({origin:"textarea",type:"blur"})},t.decorators=[{type:o.Component,args:[{selector:"th-textarea",template:'    <div class="textarea"\n        (mouseup)="onSelection($event)"\n        [attr.contenteditable]="true"\n        (blur)="onTextAreaBlur()">\n    </div>\n',styles:[".textarea{height:250px;overflow:auto;background-color:#f1f1f1;padding:20px;box-shadow:0 1px 3px rgba(0,0,0,.12),0 1px 2px rgba(0,0,0,.24);border-radius:2px;line-height:2em}.textarea:focus{outline:0}"]}]}],t.ctorParameters=function(){return[{type:undefined,decorators:[{type:o.Inject,args:[e.DOCUMENT]}]},{type:i}]},t.propDecorators={blur:[{type:o.Output}]},t}(),c=function(){function t(t){this.events=t,this.store=[]}return t.prototype.ngOnInit=function(){var e=this;this.events.listen().subscribe(function(t){"textarea"===t.origin&&"store"===t.type&&e.store.push({text:t.text,color:t.color})})},t.decorators=[{type:o.Component,args:[{selector:"th-stored-highlights",template:'<ul>\n<li *ngFor="let item of store" [ngStyle]="{\'background-color\': item.color}">{{item.text}}</li>\n</ul>\n',styles:[""]}]}],t.ctorParameters=function(){return[{type:i}]},t.propDecorators={store:[{type:o.Input,args:["store"]}]},t}(),l=function(){function t(t){this.events=t,this.colors=["#f44336","#ffeb3b","#4caf50"],this.positionX=0,this.positionY=0,this.visibility="hidden",this.markerStyle="fixed"}return t.prototype.ngOnInit=function(){var e=this;this.events.listen().subscribe(function(t){"textarea"===t.origin&&"selection"===t.type&&"float"===e.markerStyle&&(e.positionX=t.value.getRangeAt(0).getBoundingClientRect().left,e.positionY=t.value.getRangeAt(0).getBoundingClientRect().top,console.log("selection"),e.visibility="visible"),"textarea"===t.origin&&"blur"===t.type&&"float"===e.markerStyle&&(console.log("loses focus"),e.visibility="hidden")})},t.prototype.mark=function(t){this.events.dispatch({origin:"marker",type:"highlight",color:t})},t.decorators=[{type:o.Component,args:[{selector:"th-marker",template:'<div class="fixed colors" *ngIf="markerStyle === \'fixed\'">\n  <div class="color" *ngFor="let color of colors" [ngStyle]="{\'background-color\': color}" (click)="mark(color)"></div>\n</div>\n\n<div class="floating colors" *ngIf="markerStyle === \'float\'" [ngStyle]="{\'left\': positionX+\'px\', \'top\': positionY+\'px\', \'visibility\': visibility}">\n    <div class="color" *ngFor="let color of colors" [ngStyle]="{\'background-color\': color}" (click)="mark(color)"></div>\n</div>\n',styles:[".colors.fixed{width:100%;display:flex;flex-wrap:wrap}.fixed>.color{width:30px;height:30px;margin:0 10px 10px 0;cursor:pointer;box-shadow:0 1px 3px rgba(0,0,0,.12),0 1px 2px rgba(0,0,0,.24);transition:.3s cubic-bezier(.25,.8,.25,1)}.fixed>.color:hover{border-radius:50%;box-shadow:0 10px 10px rgba(0,0,0,.25),0 5px 5px rgba(0,0,0,.22)}.colors.floating{position:absolute;width:auto;background-color:#404040;border-radius:2px;box-shadow:0 1px 3px rgba(0,0,0,.12),0 1px 2px rgba(0,0,0,.24);transition:top .3s cubic-bezier(.25,.8,.25,1);display:flex}.floating>.color{margin:10px;cursor:pointer;width:30px;height:30px;transition:top .3s cubic-bezier(.25,.8,.25,1),border-radius .3s cubic-bezier(.25,.8,.25,1)}.floating>.color:hover{border-radius:50%}"]}]}],t.ctorParameters=function(){return[{type:i}]},t.propDecorators={markerStyle:[{type:o.Input,args:["markerStyle"]}]},t}(),p=function(){function t(t){this.sanitizer=t}return t.prototype.transform=function(t){return this.sanitizer.bypassSecurityTrustHtml(t)},t.decorators=[{type:o.Pipe,args:[{name:"safeHtml"}]}],t.ctorParameters=function(){return[{type:r.DomSanitizer}]},t}(),u=function(){function t(){}return t.decorators=[{type:o.NgModule,args:[{imports:[e.CommonModule],declarations:[s,a,c,l,p],exports:[s]}]}],t}();t.NgxTextHighlighterService=n,t.NgxTextHighlighterComponent=s,t.NgxTextHighlighterModule=u,t.ɵd=l,t.ɵc=c,t.ɵb=a,t.ɵe=p,t.ɵa=i,Object.defineProperty(t,"__esModule",{value:!0})});
//# sourceMappingURL=ngx-text-highlighter.umd.min.js.map